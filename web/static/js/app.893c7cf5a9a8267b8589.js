webpackJsonp([1],{165:function(e,t,n){"use strict";var s=n(19),o=n(451),a=n(92),i=n.n(a),r=n(91),c=n.n(r),l=n(94),u=n.n(l),f=n(93),d=n.n(f);s.default.use(o.a),t.a=new o.a({routes:[{path:"/",name:"Hello",component:{map:i.a,control:c.a,websocket:u.a,pie:d.a}}]})},166:function(e,t,n){"use strict";var s=n(19),o=n(95);s.default.use(o.a),t.a=new o.a.Store({state:{devices:[],runStatus:"Stopped",isConnected:!1,message:"",total:1e3},mutations:{addDev:function(e,t){e.devices.unshift(JSON.parse(t))},startScan:function(e){return e.isConnected?(e.runStatus="Running",!0):(s.default.prototype.$message.error("连接断开，无法开始扫描！"),!1)},pauseScan:function(e){e.runStatus="Paused"},stopScan:function(e){e.runStatus="Stopped"},finishScan:function(e){e.runStatus="Finished"},connectSuccess:function(e){e.isConnected=!0},connectFail:function(e){e.isConnected=!1},emit:function(e,t){e.message=t},setStat:function(e,t){e.stat=t}}})},172:function(e,t){},173:function(e,t){},174:function(e,t){},175:function(e,t){},176:function(e,t){},177:function(e,t){},178:function(e,t){},179:function(e,t,n){function s(e){n(443)}var o=n(48)(n(181),n(447),s,null,null);e.exports=o.exports},180:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(177),o=(n.n(s),n(170)),a=n.n(o),i=n(176),r=(n.n(i),n(169)),c=n.n(r),l=n(174),u=(n.n(l),n(167)),f=n.n(u),d=n(175),p=(n.n(d),n(168)),h=n.n(p),m=n(173),y=(n.n(m),n(90)),v=n.n(y),g=n(178),S=(n.n(g),n(172)),b=(n.n(S),n(171)),$=n.n(b),T=n(19),w=n(95),x=n(179),_=n.n(x),C=n(165),k=n(166),O=n(92),R=n.n(O),I=n(91),M=n.n(I),F=n(93),P=n.n(F),L=n(94),E=n.n(L);T.default.use(w.a),T.default.use($.a),T.default.use(v.a),T.default.use(h.a),T.default.use(f.a),T.default.prototype.$confirm=c.a.confirm,T.default.prototype.$message=a.a,T.default.component("echart-map",R.a),T.default.component("echart-pie",P.a),T.default.component("control-panel",M.a),T.default.component("websocket",E.a),T.default.config.productionTip=!1,new T.default({el:"#app",router:C.a,store:k.a,template:"<App/>",components:{App:_.a}})},181:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"app",data:function(){return{pieChartVisible:!1}},watch:{"$store.state.stat":{handler:function(e){this.pieChartVisible=!0},deep:!0}}}},182:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{connectStatus:"el-icon-circle-close",logInfoText:"扫描状态"}},computed:{buttonText:function(){switch(this.$store.state.runStatus){case"Running":return"暂停";case"Paused":return"继续";case"Stopped":return"开始";case"Finished":return"重新开始";default:return"开始"}}},methods:{changeScanState:function(){if(this.$store.state.isConnected)switch(this.$store.state.runStatus){case"Running":this.$store.commit("pauseScan"),this.$message.success("扫描暂停！");break;case"Paused":case"Finished":case"Stopped":this.$store.commit("startScan"),this.$message.success("扫描继续！")}else this.$message.error("失败！连接断开")},stopScan:function(){this.$store.state.isConnected?(this.$store.commit("stopScan"),this.$message.success("扫描已终止！")):this.$message.error("失败！连接断开")},restoreScan:function(){this.$store.commit("emit","restore")},generateReport:function(){this.$store.commit("emit","getStat")}},watch:{"$store.state.isConnected":{handler:function(e){this.connectStatus=e?"el-icon-circle-check":"el-icon-circle-close",e?this.$message.success("连接成功"):this.$message.error("连接断开")}}}}},183:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),o=n.n(s),a=n(435),i=(n.n(a),n(190)),r=(n.n(i),{bmap:{center:[104.114129,37.550339],zoom:1,roam:!0,mapStyle:{styleJson:[{featureType:"water",elementType:"all",stylers:{color:"#d1d1d1"}},{featureType:"land",elementType:"all",stylers:{color:"#f3f3f3"}},{featureType:"railway",elementType:"all",stylers:{visibility:"off"}},{featureType:"highway",elementType:"all",stylers:{color:"#fdfdfd"}},{featureType:"highway",elementType:"labels",stylers:{visibility:"off"}},{featureType:"arterial",elementType:"geometry",stylers:{color:"#fefefe"}},{featureType:"arterial",elementType:"geometry.fill",stylers:{color:"#fefefe"}},{featureType:"poi",elementType:"all",stylers:{visibility:"off"}},{featureType:"green",elementType:"all",stylers:{visibility:"off"}},{featureType:"subway",elementType:"all",stylers:{visibility:"off"}},{featureType:"manmade",elementType:"all",stylers:{color:"#d1d1d1"}},{featureType:"local",elementType:"all",stylers:{color:"#d1d1d1"}},{featureType:"arterial",elementType:"labels",stylers:{visibility:"off"}},{featureType:"boundary",elementType:"all",stylers:{color:"#fefefe"}},{featureType:"building",elementType:"all",stylers:{color:"#d1d1d1"}},{featureType:"label",elementType:"labels.text.fill",stylers:{color:"#999999"}}]}},backgroundColor:"#404a59",title:{text:"网络摄像头大规模扫描地图",left:"center",textStyle:{color:"#fff"}},tooltip:{trigger:"item"},legend:{orient:"vertical",y:"bottom",x:"right",data:["脆弱主机"],textStyle:{color:"#fff"}},series:[{name:"脆弱主机",type:"effectScatter",coordinateSystem:"bmap",data:[],symbolSize:function(e){return 5*e[2]},label:{normal:{formatter:"{b}",position:"right",show:!1},emphasis:{show:!0}},itemStyle:{normal:{color:"red"}}}]});t.default={data:function(){return{options:r}},mounted:function(){var e=o.a.init(this.$el);e.setOption(this.options),window.addEventListener("resize",function(){e.resize()}),this.chart=e},watch:{"$store.state.devices":{handler:function(e){var t=this.chart.getOption();t.series[0].data.push({name:e[0].addr,value:[e[0].lon,e[0].lat,1]}),this.options=t,this.chart.setOption(t)},deep:!0}}}},184:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),o=n.n(s),a=n(445),i=n.n(a),r={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",x:"left",data:["安全设备","信息泄露设备","可攻破设备"]},series:[{name:"访问来源",type:"pie",selectedMode:"single",radius:[0,"60%"],label:{normal:{position:"inner"}},labelLine:{normal:{show:!1}},data:[]}]};t.default={data:function(){return{options:r}},mounted:function(){var e=o.a.init(this.$el.querySelector(".chart"));this.options.series[0].data=[{value:this.$store.state.devices.length,name:"脆弱主机"},{value:this.$store.state.total-this.$store.state.devices.length,name:"安全设备"}],e.setOption(this.options),window.addEventListener("resize",function(){e.resize()}),this.chart=e},methods:{downloadReport:function(){var e=new i.a;e.addImage(this.chart.getDataURL(),"PNG",20,60,600,330),e.save()}},watch:{"$store.state.stat":{handler:function(e){var t=this.chart.getOption();console.log(t),t.series[0].data=[{value:this.$store.state.devices.length,name:"脆弱主机"},{value:this.$store.state.total-this.$store.state.devices.length,name:"安全设备"}],this.options=t,this.chart.setOption(t)},deep:!0}}}},185:function(e,t,n){"use strict";function s(e){this.host=e,this.client=[],this.uri=[],this.isConnected=!1}Object.defineProperty(t,"__esModule",{value:!0}),s.prototype={addListener:function(e,t){var n=this,s=this.uri.indexOf(e),o=void 0;-1===s?(o=new WebSocket(this.host+e),this.client.push(o),this.uri.push(e)):o=this.client[s],o.onopen=function(){n.isConnected=!0},o.onclose=function(){n.isConnected=!1},o.onmessage=function(e){t(o,e.data)}},sendMessage:function(e,t){var n=this.uri.indexOf(e),s=void 0;-1===n?(s=new WebSocket(this.host+e),this.client.push(s),this.uri.push(e)):s=this.client[n],console.log(this),s.send(t)}},t.default={data:function(){return{logInfoText:"此处为扫描日志",con:{}}},mounted:function(){var e=this,t=new s("ws://localhost/");t.addListener("logInfo",function(t,n){e.logInfoText+=n;var s=document.getElementById("logInfo");s.value=e.logInfoText,s.scrollTop=s.scrollHeight}),t.addListener("scanDev",function(t,n){"finishScan"===n?(e.$store.commit("finishScan"),e.$message.info("扫描结束")):(console.log(n),n&&e.$store.commit("addDev",n),"Running"===e.$store.state.runStatus&&e.con.sendMessage("scanDev","scanNext"))}),t.addListener("restore",function(t,n){"restoreFinish"===n?e.$message.success("数据恢复成功"):e.$store.commit("addDev",n)}),t.addListener("getStat",function(t,n){console.log("report stat"),console.log(n),e.$store.commit("setStat",n)}),this.con=t},watch:{"$store.state.runStatus":{handler:function(e){switch(e){case"Running":this.con.sendMessage("scanDev","scanNext");break;case"Stopped":this.con.sendMessage("clear")}}},"$store.state.message":{handler:function(e){this.con.sendMessage(e,"trigger")}},"con.isConnected":{handler:function(e){e?(this.$store.commit("connectSuccess"),this.$message.success("连接成功")):(this.$store.commit("connectFail"),this.$message.error("连接断开"))}}}}},443:function(e,t){},444:function(e,t){},446:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"full-height"},[n("div",{staticClass:"chart"}),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.downloadReport}},[e._v("下载报告")])],1)},staticRenderFns:[]}},447:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("el-row",[n("echart-map")],1),e._v(" "),n("control-panel"),e._v(" "),n("el-dialog",{attrs:{title:"检测报告",visible:e.pieChartVisible},on:{"update:visible":function(t){e.pieChartVisible=t}}},[n("echart-pie")],1),e._v(" "),n("websocket")],1)},staticRenderFns:[]}},448:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",[n("el-button",{attrs:{type:"primary"},on:{click:e.changeScanState}},[e._v(e._s(e.buttonText))]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.stopScan}},[e._v("结束扫描")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.restoreScan}},[e._v("从数据库恢复")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.generateReport}},[e._v("生成报告")]),e._v(" "),n("i",{class:e.connectStatus,attrs:{id:"connection"}}),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.logInfoText,expression:"logInfoText"}],attrs:{id:"logInfo",readonly:""},domProps:{value:e.logInfoText},on:{input:function(t){t.target.composing||(e.logInfoText=t.target.value)}}})],1)},staticRenderFns:[]}},449:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"chart"})},staticRenderFns:[]}},450:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div")},staticRenderFns:[]}},91:function(e,t,n){function s(e){n(444)}var o=n(48)(n(182),n(448),s,null,null);e.exports=o.exports},92:function(e,t,n){var s=n(48)(n(183),n(449),null,null,null);e.exports=s.exports},93:function(e,t,n){var s=n(48)(n(184),n(446),null,null,null);e.exports=s.exports},94:function(e,t,n){var s=n(48)(n(185),n(450),null,null,null);e.exports=s.exports}},[180]);
//# sourceMappingURL=app.893c7cf5a9a8267b8589.js.map